---
title: "[安全] 拒绝 22 号门：修改 SSH 默认端口防止扫描"
pubDatetime: 2025-12-02T21:15:00.000+08:00
description: "默认的 22 端口是黑客的最爱。本文教你如何修改 SSH 端口，让暴力破解脚本找不到北。"
tags:
  - VPS
  - Security
  - Linux
---

默认的 SSH 端口是 22，这也是黑客扫描脚本最喜欢攻击的目标。如果你不想让你的日志里塞满暴力破解的记录，最简单的方法就是：换个门走。

我们将把端口修改为高位端口（比如 56789），这样既安全，又不容易和常用软件冲突。

### 第一步：修改配置文件

首先，我们需要编辑 SSH 的核心配置文件。在 SSH 终端输入以下命令：

    nano /etc/ssh/sshd_config

### 第二步：更改端口号

进入编辑器后，按键盘上下键，找到写着 `Port 22` 的这一行。

1.  把前面的 `#` 号去掉（如果有的话）。
2.  把 `22` 改成你想要的端口，比如 `56789`。

*(修改后的样子应该是这样的：)*

    Port 56789

改完后，按 `Ctrl + O` 保存（按回车确认），然后按 `Ctrl + X` 退出编辑器。

### 第三步：放行防火墙 (🚨 极其重要！)

**这是新手最容易忽略的一步！** 如果你的 VPS 开启了防火墙（比如 UFW 或 iptables），却没放行新端口，重启服务后你就会被拒绝连接。

* **如果你是 Debian/Ubuntu 且装了 UFW：**

      ufw allow 56789/tcp

* **⚠️ 特别注意（云厂商防火墙）：**
    如果你用的是 **Google Cloud (GCP)**、AWS 或 Oracle Cloud，你必须去网页后台的“防火墙规则”或“安全组”里，手动添加一个规则，允许 TCP 协议的 56789 端口入站。

### 第四步：重启 SSH 服务

配置改了，防火墙通了，现在重启服务让它生效。输入：

    systemctl restart sshd

---

### ⚠️ 救命原则：不要立刻关窗口！

这是新手最容易犯的错误：改完重启后直接关掉了当前的连接。万一刚才改错了，你就再也进不去了。

**正确的做法是：**

1.  **保留当前窗口不动**（作为保底通道）。
2.  **新开**一个 CMD 或终端窗口。
3.  尝试用新端口连接：

      ssh root@你的IP -p 56789

如果新窗口能登录成功，说明修改没问题，这时再把旧窗口关掉。

---

### 💡 以后如何连接？

修改端口后，以后每次连接都需要带上 `-p` 参数：

* **CMD / 终端连接：**

      ssh root@ip -p 56789

* **SSH 软件（Xshell/FinalShell 等）：** 在端口（Port）一栏填入 `56789`。
